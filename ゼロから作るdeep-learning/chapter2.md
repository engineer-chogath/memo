# パーセプトロンとは
* ローゼンブラットが1957年に考察したアルゴリズム
* ニュートラルネットワーク（ディープラーニング）の起源
* 人口ニューロン/単純パーセプトロンと呼ばれるものを取り扱う

## 仕組み
x1, x2を入力信号とし、yは出力信号とする。  
また、w1, w2を重みとして表す（wはweightの頭文字）。  
各x1, x2, yは「ニューロン」「ノード」といった表記をする。  

x1, x2は対応する重み(w)と乗算することで出力信号を算出する。  
そして、出力信号が一定以上の値となったとき、1を出力する（発火するともいう）。  
また、その限界を「閾値」と呼び、Θで表す。

例:  
* (w1 * x1 + w2 * x2 <= Θ) = 0
* (w1 * x1 + w2 * x2 > Θ) = 1

## ANDゲート
### ANDゲートの真理値表
|  x1 |  x2  | y |
| --- | ---- | - |
|  0  |  0   | 0 |
|  1  |  0   | 0 |
|  0  |  1   | 0 |
|  1  |  1   | 1 |

ここで、上記を満たす重みと閾値、w1, w2, Θを考えるが  
これらを満たす重みは無限大に存在することとなる。  
例:  
* (0.5, 0.5, 0.7)
* (1.0, 2.0, 2.5)

## NANDゲート
### NANDゲートの真理値表
|  x1 |  x2  | y |
| --- | ---- | - |
|  0  |  0   | 1 |
|  1  |  0   | 1 |
|  0  |  1   | 1 |
|  1  |  1   | 0 |

AND条件の符号を反転する。
また、AND条件と同様、無限大に解は存在する。
例:  
* (-0.5, -0.5, -0.7)
* (-1.0, -2.0, -2.5)

## ORゲート
### ORゲートの真理値表
|  x1 |  x2  | y |
| --- | ---- | - |
|  0  |  0   | 0 |
|  1  |  0   | 1 |
|  0  |  1   | 1 |
|  1  |  1   | 1 |

例:  
* (-0.5, -0.5, -0.4)
* (1.5, 2.0, 1.5)

## 実装
```
def AND(x1, x2):
   w1, w2, theta = 0.5, 0.5, 0.7
   tmp = x1*w1 + x2*w2
   if tmp <= theta:
       return 0
   elif tmp > theta:
       return 1

>>> AND(0, 0)
0
>>> AND(1, 0)
0
>>> AND(0, 1)
0
>>> AND(1, 1)
1
```

また、Θを-b（バイアス）とし式を変換して以下のように考える。
* (b+ w1\*x1 + w2\*w2 <= 0) = 0
* (b+ w1\*x1 + w2\*w2 > 0) = 1

numpyを用いた実装が以下通り。
```
import numpy as np

def AND(x1, x2):
    x = np.array([x1, x2])
    w = np.array([0.5, 0.5])
    b = -0.7
    tmp = np.sum(w*x) + b
    if tmp <= 0:
        return 0
    else:
        return 1

def NAND(x1, x2):
    x = np.array([x1, x2])
    w = np.array([-0.5, -0.5])
    b = 0.7
    tmp = np.sum(w*x) + b
    if tmp <= 0:
        return 0
    else:
        return 1

def OR(x1, x2):
    x = np.array([x1, x2])
    w = np.array([0.5, 0.5])
    b = -0.2
    tmp = np.sum(w*x) + b
    if tmp <= 0:
        return 0
    else:
        return 1
```

## XORゲート
* XORゲートは排他的論理和ともいわれる
* x1, x2のどちらかのみが1の場合に出力が1となる
### XORゲートの真理値表
|  x1 |  x2  | y |
| --- | ---- | - |
|  0  |  0   | 0 |
|  1  |  0   | 1 |
|  0  |  1   | 1 |
|  1  |  1   | 0 |

これを今までのパーセプトロンでは実現できない。  
表に配置した場合、直線で分けられないためであり、  
分けられるものを線形、分けられないものを非線形という。

## 多層パーセプトロン
* パーセプトロンは層を重ねることができる
* ゲートの組み合わせでXORを実現できる

ゲートs1, s2, s3を定める。
s1はNAND, s2はOR, s3はANDゲートの入力とし、
s3にはs1, s2それぞれの値が渡るとするとNANDゲートが実現可能。
### XORゲートの真理値表
|  x1 |  x2  |  s1 |  s2  | y |
| --- | ---- | --- | ---- | - |
|  0  |  0   |  1  |  0   | 0 |
|  1  |  0   |  1  |  1   | 1 |
|  0  |  1   |  1  |  1   | 1 |
|  1  |  1   |  0  |  1   | 0 |

### XORゲートの実装
```
def XOR(x1, x2):
    s1 = NAND(x1, x2)
    s2 = OR(x1, x2)
    y = AND(s1, s2)
    return y
```

このように層を組み合わせたパーセプトロンを多層パーセプトロンという。
